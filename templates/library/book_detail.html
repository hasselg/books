{% extends "library/base.html" %}
{% block title %}Books - Details{% endblock %}

{% block extraheaditems %}
<link href="/media/jquery-ui/jquery-ui-1.8.5.css" rel="stylesheet" type="text/css" />
<link href="/media/selectlist/selectlist.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="/media/scripts/jquery-ui-1.8.5.min.js"></script>
<script type="text/javascript" src="/media/scripts/jquery.form.js"></script>
<script type="text/javascript" src="/media/selectlist/jquery.selectlist.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    // Setup our dialog
    $("#dialog").dialog({ autoOpen: false , modal: true});
    
    // Setup our fancy author select widget
    $("#id_author").selectList({ sort: true });

    // Wire up our add author form
    $("#addAuthor").ajaxForm({
        url: '/books/library/create_author_ajax/',
        dataType: 'json',
        success: function (data) {
            var new_author = "<option value=\"" + data.pk + "\">" + data.author + "</option>";
            $("#id_author").append(new_author);
            $("#dialog").dialog("close");
        },
        resetForm: true
    });
});

function add_author() {
  $("#dialog").dialog("open");
}

</script>
{% endblock %}

{% block content %}
<form action="" method="post">
{% csrf_token %}
{{ book_form.as_p }}
<a href="#" onclick="javascript:add_author()">add a new author</a>
<br />
<input type="submit" value="Save changes" />
</form>


<div id="dialog" title="Add a New Author">
    <form id="addAuthor" method="post">
    {% csrf_token %}
    {{ author_form.as_p }}
    <input type="submit" value="add" />
</div>
{% endblock %}

